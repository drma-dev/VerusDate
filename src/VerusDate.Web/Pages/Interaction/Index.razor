@page "/Interaction"
@attribute [Authorize]
@inherits PageCore<Interaction.Index>

<Row>
    <Column>
        <Card Margin="Margin.Is3.FromBottom">
            <CardHeader>Matches</CardHeader>
            <CardBody>
                @if (OptionsMatches.HasCustomVisibility)
                {
                    <CustomVisibility Options="OptionsMatches"></CustomVisibility>
                }
                else
                {
                    <Row>
                        @foreach (var item in Matches)
                        {
                            <Column ColumnSize="ColumnSize.Is3.OnFullHD.Is4.OnWidescreen.Is6.OnDesktop.Is12.OnMobile">
                                <Blazorise.Link To="@("/Interaction/View/" + item.IdUserInteraction)">
                                    <Card Margin="Margin.Is3.FromBottom.OnMobile.Is0.OnFullHD">
                                        <CardImage Source="@item.GetMainPhoto(TypeUser.InteractionUser)" Alt="Photo Image"></CardImage>
                                        <CardText Color="TextColor.Secondary" Alignment="TextAlignment.Center" Weight="TextWeight.Bold" Style="font-size: 11px;">
                                            @item.NickNameInteraction
                                        </CardText>
                                    </Card>
                                </Blazorise.Link>
                            </Column>
                        }
                    </Row>
                }
            </CardBody>
        </Card>
        <Card Margin="Margin.Is3.FromBottom">
            <CardHeader>Likes</CardHeader>
            <CardBody>
                @if (OptionsLikes.HasCustomVisibility)
                {
                    <CustomVisibility Options="OptionsLikes"></CustomVisibility>
                }
                else
                {
                    <Row>
                        @foreach (var item in Likes)
                        {
                            <Column ColumnSize="ColumnSize.Is3.OnFullHD.Is4.OnWidescreen.Is6.OnDesktop.Is12.OnMobile">
                                <Blazorise.Link To="@("/Interaction/View/" + item.IdLoggedUser)">
                                    <Card Margin="Margin.Is3.FromBottom.OnMobile.Is0.OnFullHD">
                                        <CardImage Source="@item.GetMainPhoto(TypeUser.LoggedUser)" Alt="Photo Image"></CardImage>
                                        <CardText Color="TextColor.Secondary" Alignment="TextAlignment.Center" Weight="TextWeight.Bold" Style="font-size: 11px;">
                                            @item.NickNameLoggedUser
                                        </CardText>
                                    </Card>
                                </Blazorise.Link>
                            </Column>
                        }
                    </Row>
                }
            </CardBody>
        </Card>
    </Column>
    <Column>
        <Card Margin="Margin.Is3.FromBottom">
            <CardHeader>Mensagens</CardHeader>
            <CardBody>
                EM DESENVOLVIMENTO
            </CardBody>
        </Card>
        <Card Margin="Margin.Is3.FromBottom">
            <CardHeader>Piscadinhas</CardHeader>
            <CardBody>
                @if (OptionsBlinks.HasCustomVisibility)
                {
                    <CustomVisibility Options="OptionsBlinks"></CustomVisibility>
                }
                else
                {
                    <Row>
                        @foreach (var item in Blinks)
                        {
                            <Column ColumnSize="ColumnSize.Is3.OnFullHD.Is4.OnWidescreen.Is6.OnDesktop.Is12.OnMobile">
                                <Blazorise.Link To="@("/Interaction/View/" + item.IdLoggedUser)">
                                    <Card Margin="Margin.Is3.FromBottom.OnMobile.Is0.OnFullHD">
                                        <CardImage Source="@item.GetMainPhoto(TypeUser.LoggedUser)" Alt="Photo Image"></CardImage>
                                        <CardText Color="TextColor.Secondary" Alignment="TextAlignment.Center" Weight="TextWeight.Bold" Style="font-size: 11px;">
                                            @item.NickNameLoggedUser
                                        </CardText>
                                    </Card>
                                </Blazorise.Link>
                            </Column>
                        }
                    </Row>
                }
            </CardBody>
        </Card>
    </Column>
</Row>

@code {
    private List<InteractionQuery> Matches { get; set; }
    private List<InteractionQuery> Likes { get; set; }
    private List<InteractionQuery> Blinks { get; set; }

    private VisibilityOptions OptionsMatches => new VisibilityOptions()
    {
        Loading = IsLoading,
        NoData = Matches == null || !Matches.Any()
    };

    private VisibilityOptions OptionsLikes => new VisibilityOptions()
    {
        //Premium = true,
        Loading = IsLoading,
        NoData = Likes == null || !Likes.Any()
    };

    private VisibilityOptions OptionsBlinks => new VisibilityOptions()
    {
        Loading = IsLoading,
        NoData = Blinks == null || !Blinks.Any()
    };

    protected override async Task LoadData()
    {
        Matches = await Http.Interation_GetMyMatches(SessionStorage);
        Likes = await Http.Interation_GetLikes(SessionStorage);
        Blinks = await Http.Interation_GetBlinks(SessionStorage);
    }
}